 import numpy as np
 import matplotlib.pyplot as plt
 import pandas as pd
 import seaborn as sns
 from sklearn.model_selection import train_test_split
 from sklearn.linear_model import LinearRegression
 df=pd.read_csv("temperatures.csv")

  count=(df["JAN"]==22).sum()
 print(count)

  column=df
 column[column==0].count()

 df.isnull()

 df.isnull.sum()

  x=df["YEAR"]
 y=df["ANNUAL"]

 
 plt.plot(x,y,'o')

 sns.scatterplot(x=x,y=y,data=df)

 type(x)

 x.shape

 x=x.values
 x=x.reshape(117,1)
 x.shape

 type(x)


  x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.25)

  
 print(f"x training dataset: {x_train.shape}")
 print(f"x testing dataset: {x_test.shape}")
 print(f"y training dataset: {y_train.shape}")
 print(f"y testing dataset: {y_test.shape}")
 x training dataset: (87, 1)
 x testing dataset: (30, 1)
 y training dataset: (87,)
 y testing dataset: (30,)

 
  print(x_train.shape,y_train.shape)

   print(x_test.shape,y_test.shape)
 model = LinearRegression()


 model.fit(x_train,y_train)

 model.coef_

 model.intercept_

 y_pred=model.predict(x_test)

 y_pred.shape


plt.scatter(x_train,y_train,color='blue')
 plt.plot(x_test,y_pred,color='red',linewidth=3)
 plt.title("Temperature vs Year")
 plt.xlabel("Year")
 plt.ylabel("Temperature")
 plt.show()


 sns.regplot(data=df,x=x_train,y=y_train)

 
 
 from sklearn.metrics import mean_absolute_error,mean_squared_error,r2_score
 print(f"MSE:  {mean_squared_error(y_test,y_pred)}")
 print(f"MAE:  {mean_absolute_error(y_test,y_pred)}")
 print(f"R-Sqaure :  {r2_score(y_test,y_pred)}")
 
 
